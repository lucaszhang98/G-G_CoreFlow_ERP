# Excel 转换工具 - 可执行文件版本

## 使用说明

### 方法一：使用打包好的 exe 文件（推荐）

1. **解压文件**
   - 将 `excel-transfer-standalone.exe` 放到任意目录（例如：`D:\Excel转换工具\`）

2. **准备文件**
   - 在 exe 文件所在目录创建以下文件夹：
     - `data/` - 放置客户填写的模板文件（.xlsx）
     - `templates/` - 放置订单导入模板文件（.xlsx）
     - `output/` - 转换后的文件会输出到这里（自动创建）

3. **运行程序**
   - 双击 `excel-transfer-standalone.exe`
   - 程序会自动查找 `data/` 目录中的源文件
   - 转换完成后，结果文件会保存在 `output/` 目录

4. **查看结果**
   - 转换后的文件名格式：`源文件名_转换结果_日期.xlsx`
   - 例如：`EGLV143570965986 预报_转换结果_2026-01-19.xlsx`

### 方法二：从源码构建（开发者）

1. **安装依赖**
   ```bash
   npm install
   ```

2. **构建 exe**
   ```bash
   npm run build:exe
   ```

3. **输出位置**
   - 构建好的 exe 文件在 `dist/` 目录

## 目录结构

```
excel-transfer-standalone.exe
├── data/              # 源文件目录（客户填写模板）
│   └── *.xlsx
├── templates/         # 模板文件目录（订单导入模板）
│   └── *.xlsx
└── output/            # 输出目录（转换结果）
    └── *_转换结果_*.xlsx
```

## 注意事项

1. **文件格式**
   - 只支持 `.xlsx` 格式的 Excel 文件
   - 源文件必须是客户填写的模板格式

2. **文件命名**
   - 源文件可以任意命名
   - 模板文件可以任意命名（程序会自动查找）

3. **错误处理**
   - 如果 `data/` 目录为空，程序会提示并退出
   - 如果 `templates/` 目录为空，程序会提示并退出
   - 转换过程中的错误会显示在控制台

4. **杀毒软件**
   - 某些杀毒软件可能会误报，这是正常现象
   - 可以添加到白名单或信任列表

## 转换规则

1. **直接转移**：订单号、客户代码、操作方式、货柜类型、ETA、MBL
2. **目的地**：如果操作方式是"拆柜"，自动填"GG"；否则使用源文件中的目的地
3. **订单日期**：自动填充当日日期（只包含年月日）
4. **送仓地点汇总**：按"仓库代码"分组汇总
5. **数量、体积**：按送仓地点汇总求和
6. **FBA、PO**：相同送仓地点的值用换行符拼接
7. **性质**：从"派送方式"读取
8. **DO**：默认为"否"

## 技术支持

如有问题，请联系开发团队。
