# Netlify 配置文件
# 这个文件会被 Netlify 自动读取，用于配置构建和部署过程

[build]
  # 构建命令
  command = "npm run build"

[build.environment]
  # Node.js 版本
  NODE_VERSION = "20"
  # Prisma 二进制目标，确保在 Netlify 服务器上使用正确的查询引擎
  PRISMA_CLI_BINARY_TARGETS = "rhel-openssl-3.0.x"

# Netlify Next.js 插件配置
# 这个插件会自动处理 Next.js 的构建和部署，包括函数打包和依赖管理
# 注意：插件需要在 Netlify 平台上安装，不需要在 package.json 中
# 插件会自动处理：
# - Next.js 路由和 API 路由
# - 中间件
# - 静态文件
# - 重定向规则
[[plugins]]
  package = "@netlify/plugin-nextjs"

# 函数配置
# Netlify Next.js 插件会自动处理必要的文件打包
# 注意：不要使用 included_files = ["**"]，这会让函数包变得非常大
[functions]
  # 函数超时时间（秒）- Netlify 免费版最大 10 秒，Pro 版最大 26 秒
  timeout = 10
  # 使用 esbuild 进行打包（默认值，明确指定以确保一致性）
  node_bundler = "esbuild"
